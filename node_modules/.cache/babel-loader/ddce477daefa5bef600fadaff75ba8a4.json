{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { ItemConfig } from '../config/config';\nimport { ResolvedHeaderedItemConfig, ResolvedItemConfig, ResolvedStackItemConfig } from '../config/resolved-config';\nimport { Header } from '../controls/header';\nimport { AssertError, UnexpectedNullError, UnexpectedUndefinedError } from '../errors/internal-error';\nimport { EventEmitter } from '../utils/event-emitter';\nimport { getJQueryOffset } from '../utils/jquery-legacy';\nimport { ItemType, Side, WidthOrHeightPropertyName } from '../utils/types';\nimport { getElementHeight, getElementWidth, getElementWidthAndHeight, numberToPixels, setElementDisplayVisibility } from '../utils/utils';\nimport { ComponentItem } from './component-item';\nimport { ComponentParentableItem } from './component-parentable-item';\nimport { ContentItem } from './content-item';\n/** @public */\n\nexport class Stack extends ComponentParentableItem {\n  /** @internal */\n  constructor(layoutManager, config, parent) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u;\n\n    super(layoutManager, config, parent, Stack.createElement(document));\n    /** @internal */\n\n    this._headerSideChanged = false;\n    /** @internal */\n\n    this._resizeListener = () => this.handleResize();\n    /** @internal */\n\n\n    this._maximisedListener = () => this.handleMaximised();\n    /** @internal */\n\n\n    this._minimisedListener = () => this.handleMinimised();\n\n    this._headerConfig = config.header;\n    const layoutHeaderConfig = layoutManager.layoutConfig.header;\n    const configContent = config.content; // If stack has only one component, then we can also check this for header settings\n\n    let componentHeaderConfig;\n\n    if (configContent.length !== 1) {\n      componentHeaderConfig = undefined;\n    } else {\n      const firstChildItemConfig = configContent[0];\n      componentHeaderConfig = firstChildItemConfig.header; // will be undefined if not component (and wont be stack)\n    }\n\n    this._initialWantMaximise = config.maximised;\n    this._initialActiveItemIndex = (_a = config.activeItemIndex) !== null && _a !== void 0 ? _a : 0; // make sure defined\n    // check for defined value for each item in order of Stack (this Item), Component (first child), Manager.\n\n    const show = (_d = (_c = (_b = this._headerConfig) === null || _b === void 0 ? void 0 : _b.show) !== null && _c !== void 0 ? _c : componentHeaderConfig === null || componentHeaderConfig === void 0 ? void 0 : componentHeaderConfig.show) !== null && _d !== void 0 ? _d : layoutHeaderConfig.show;\n    const popout = (_g = (_f = (_e = this._headerConfig) === null || _e === void 0 ? void 0 : _e.popout) !== null && _f !== void 0 ? _f : componentHeaderConfig === null || componentHeaderConfig === void 0 ? void 0 : componentHeaderConfig.popout) !== null && _g !== void 0 ? _g : layoutHeaderConfig.popout;\n    const maximise = (_k = (_j = (_h = this._headerConfig) === null || _h === void 0 ? void 0 : _h.maximise) !== null && _j !== void 0 ? _j : componentHeaderConfig === null || componentHeaderConfig === void 0 ? void 0 : componentHeaderConfig.maximise) !== null && _k !== void 0 ? _k : layoutHeaderConfig.maximise;\n    const close = (_o = (_m = (_l = this._headerConfig) === null || _l === void 0 ? void 0 : _l.close) !== null && _m !== void 0 ? _m : componentHeaderConfig === null || componentHeaderConfig === void 0 ? void 0 : componentHeaderConfig.close) !== null && _o !== void 0 ? _o : layoutHeaderConfig.close;\n    const minimise = (_r = (_q = (_p = this._headerConfig) === null || _p === void 0 ? void 0 : _p.minimise) !== null && _q !== void 0 ? _q : componentHeaderConfig === null || componentHeaderConfig === void 0 ? void 0 : componentHeaderConfig.minimise) !== null && _r !== void 0 ? _r : layoutHeaderConfig.minimise;\n    const tabDropdown = (_u = (_t = (_s = this._headerConfig) === null || _s === void 0 ? void 0 : _s.tabDropdown) !== null && _t !== void 0 ? _t : componentHeaderConfig === null || componentHeaderConfig === void 0 ? void 0 : componentHeaderConfig.tabDropdown) !== null && _u !== void 0 ? _u : layoutHeaderConfig.tabDropdown;\n    this._maximisedEnabled = maximise !== false;\n    const headerSettings = {\n      show: show !== false,\n      side: show === false ? Side.top : show,\n      popoutEnabled: popout !== false,\n      popoutLabel: popout === false ? '' : popout,\n      maximiseEnabled: this._maximisedEnabled,\n      maximiseLabel: maximise === false ? '' : maximise,\n      closeEnabled: close !== false,\n      closeLabel: close === false ? '' : close,\n      minimiseEnabled: true,\n      minimiseLabel: minimise,\n      tabDropdownEnabled: tabDropdown !== false,\n      tabDropdownLabel: tabDropdown === false ? '' : tabDropdown\n    };\n    this._header = new Header(layoutManager, this, headerSettings, config.isClosable && close !== false, () => this.getActiveComponentItem(), () => this.remove(), () => this.handlePopoutEvent(), () => this.toggleMaximise(), ev => this.handleHeaderClickEvent(ev), ev => this.handleHeaderTouchStartEvent(ev), item => this.handleHeaderComponentRemoveEvent(item), item => this.handleHeaderComponentFocusEvent(item), (x, y, dragListener, item) => this.handleHeaderComponentStartDragEvent(x, y, dragListener, item)); // this._dropZones = {};\n\n    this.isStack = true;\n    this._childElementContainer = document.createElement('section');\n\n    this._childElementContainer.classList.add(\"lm_items\"\n    /* Items */\n    );\n\n    this.on('resize', this._resizeListener);\n\n    if (this._maximisedEnabled) {\n      this.on('maximised', this._maximisedListener);\n      this.on('minimised', this._minimisedListener);\n    }\n\n    this.element.appendChild(this._header.element);\n    this.element.appendChild(this._childElementContainer);\n    this.setupHeaderPosition();\n\n    this._header.updateClosability();\n  }\n\n  get childElementContainer() {\n    return this._childElementContainer;\n  }\n\n  get header() {\n    return this._header;\n  }\n\n  get headerShow() {\n    return this._header.show;\n  }\n\n  get headerSide() {\n    return this._header.side;\n  }\n\n  get headerLeftRightSided() {\n    return this._header.leftRightSided;\n  }\n  /** @internal */\n\n\n  get contentAreaDimensions() {\n    return this._contentAreaDimensions;\n  }\n  /** @internal */\n\n\n  get initialWantMaximise() {\n    return this._initialWantMaximise;\n  }\n\n  get isMaximised() {\n    return this === this.layoutManager.maximisedStack;\n  }\n\n  get stackParent() {\n    if (!this.parent) {\n      throw new Error('Stack should always have a parent');\n    }\n\n    return this.parent;\n  }\n  /** @internal */\n\n\n  updateSize() {\n    this.layoutManager.beginVirtualSizedContainerAdding();\n\n    try {\n      this.updateNodeSize();\n      this.updateContentItemsSize();\n    } finally {\n      this.layoutManager.endVirtualSizedContainerAdding();\n    }\n  }\n  /** @internal */\n\n\n  init() {\n    if (this.isInitialised === true) return;\n    this.updateNodeSize();\n\n    for (let i = 0; i < this.contentItems.length; i++) {\n      this._childElementContainer.appendChild(this.contentItems[i].element);\n    }\n\n    super.init();\n    const contentItems = this.contentItems;\n    const contentItemCount = contentItems.length;\n\n    if (contentItemCount > 0) {\n      // contentItemCount will be 0 on drag drop\n      if (this._initialActiveItemIndex < 0 || this._initialActiveItemIndex >= contentItemCount) {\n        throw new Error(`ActiveItemIndex out of range: ${this._initialActiveItemIndex} id: ${this.id}`);\n      } else {\n        for (let i = 0; i < contentItemCount; i++) {\n          const contentItem = contentItems[i];\n\n          if (!(contentItem instanceof ComponentItem)) {\n            throw new Error(`Stack Content Item is not of type ComponentItem: ${i} id: ${this.id}`);\n          } else {\n            this._header.createTab(contentItem, i);\n\n            contentItem.hide();\n          }\n        }\n\n        this.setActiveComponentItem(contentItems[this._initialActiveItemIndex], false);\n\n        this._header.updateTabSizes();\n      }\n    }\n\n    this._header.updateClosability();\n\n    this.initContentItems();\n  }\n  /** @deprecated Use {@link (Stack:class).setActiveComponentItem} */\n\n\n  setActiveContentItem(item) {\n    if (!ContentItem.isComponentItem(item)) {\n      throw new Error('Stack.setActiveContentItem: item is not a ComponentItem');\n    } else {\n      this.setActiveComponentItem(item, false);\n    }\n  }\n\n  setActiveComponentItem(componentItem, focus, suppressFocusEvent = false) {\n    if (this._activeComponentItem !== componentItem) {\n      if (this.contentItems.indexOf(componentItem) === -1) {\n        throw new Error('componentItem is not a child of this stack');\n      } else {\n        if (this._activeComponentItem !== undefined) {\n          this._activeComponentItem.hide();\n        }\n\n        this._activeComponentItem = componentItem;\n\n        this._header.processActiveComponentChanged(componentItem);\n\n        componentItem.show();\n        this.emit('activeContentItemChanged', componentItem);\n        this.layoutManager.emit('activeContentItemChanged', componentItem);\n        this.emitStateChangedEvent();\n      }\n    }\n\n    if (this.focused || focus) {\n      this.layoutManager.setFocusedComponentItem(componentItem, suppressFocusEvent);\n    }\n  }\n  /** @deprecated Use {@link (Stack:class).getActiveComponentItem} */\n\n\n  getActiveContentItem() {\n    var _a;\n\n    return (_a = this.getActiveComponentItem()) !== null && _a !== void 0 ? _a : null;\n  }\n\n  getActiveComponentItem() {\n    return this._activeComponentItem;\n  }\n  /** @internal */\n\n\n  focusActiveContentItem() {\n    var _a;\n\n    (_a = this._activeComponentItem) === null || _a === void 0 ? void 0 : _a.focus();\n  }\n  /** @internal */\n\n\n  setFocusedValue(value) {\n    this._header.applyFocusedValue(value);\n\n    super.setFocusedValue(value);\n  }\n  /** @internal */\n\n\n  setRowColumnClosable(value) {\n    this._header.setRowColumnClosable(value);\n  }\n\n  newComponent(componentType, componentState, title, index) {\n    const itemConfig = {\n      type: 'component',\n      componentType,\n      componentState,\n      title\n    };\n    return this.newItem(itemConfig, index);\n  }\n\n  addComponent(componentType, componentState, title, index) {\n    const itemConfig = {\n      type: 'component',\n      componentType,\n      componentState,\n      title\n    };\n    return this.addItem(itemConfig, index);\n  }\n\n  newItem(itemConfig, index) {\n    index = this.addItem(itemConfig, index);\n    return this.contentItems[index];\n  }\n\n  addItem(itemConfig, index) {\n    this.layoutManager.checkMinimiseMaximisedStack();\n    const resolvedItemConfig = ItemConfig.resolve(itemConfig);\n    const contentItem = this.layoutManager.createAndInitContentItem(resolvedItemConfig, this);\n    return this.addChild(contentItem, index);\n  }\n\n  addChild(contentItem, index, focus = false) {\n    if (index !== undefined && index > this.contentItems.length) {\n      index -= 1;\n      throw new AssertError('SAC99728'); // undisplayChild() removed so this condition should no longer occur\n    }\n\n    if (!(contentItem instanceof ComponentItem)) {\n      throw new AssertError('SACC88532'); // Stacks can only have Component children\n    } else {\n      index = super.addChild(contentItem, index);\n\n      this._childElementContainer.appendChild(contentItem.element);\n\n      this._header.createTab(contentItem, index);\n\n      this.setActiveComponentItem(contentItem, focus);\n\n      this._header.updateTabSizes();\n\n      this.updateSize();\n\n      this._header.updateClosability();\n\n      this.emitStateChangedEvent();\n      return index;\n    }\n  }\n\n  removeChild(contentItem, keepChild) {\n    const componentItem = contentItem;\n    const index = this.contentItems.indexOf(componentItem);\n    const stackWillBeDeleted = this.contentItems.length === 1;\n\n    if (this._activeComponentItem === componentItem) {\n      if (componentItem.focused) {\n        componentItem.blur();\n      }\n\n      if (!stackWillBeDeleted) {\n        // At this point we're already sure we have at least one content item left *after*\n        // removing contentItem, so we can safely assume index 1 is a valid one if\n        // the index of contentItem is 0, otherwise we just use the previous content item.\n        const newActiveComponentIdx = index === 0 ? 1 : index - 1;\n        this.setActiveComponentItem(this.contentItems[newActiveComponentIdx], false);\n      }\n    }\n\n    this._header.removeTab(componentItem);\n\n    super.removeChild(componentItem, keepChild);\n\n    if (!stackWillBeDeleted) {\n      this._header.updateClosability();\n    }\n\n    this.emitStateChangedEvent();\n  }\n  /**\n   * Maximises the Item or minimises it if it is already maximised\n   */\n\n\n  toggleMaximise() {\n    if (this.isMaximised) {\n      this.minimise();\n    } else {\n      this.maximise();\n    }\n  }\n\n  maximise() {\n    if (!this.isMaximised) {\n      this.layoutManager.setMaximisedStack(this);\n      const contentItems = this.contentItems;\n      const contentItemCount = contentItems.length;\n\n      for (let i = 0; i < contentItemCount; i++) {\n        const contentItem = contentItems[i];\n\n        if (contentItem instanceof ComponentItem) {\n          contentItem.enterStackMaximised();\n        } else {\n          throw new AssertError('SMAXI87773');\n        }\n      }\n\n      this.emitStateChangedEvent();\n    }\n  }\n\n  minimise() {\n    if (this.isMaximised) {\n      this.layoutManager.setMaximisedStack(undefined);\n      const contentItems = this.contentItems;\n      const contentItemCount = contentItems.length;\n\n      for (let i = 0; i < contentItemCount; i++) {\n        const contentItem = contentItems[i];\n\n        if (contentItem instanceof ComponentItem) {\n          contentItem.exitStackMaximised();\n        } else {\n          throw new AssertError('SMINI87773');\n        }\n      }\n\n      this.emitStateChangedEvent();\n    }\n  }\n  /** @internal */\n\n\n  destroy() {\n    var _a;\n\n    if ((_a = this._activeComponentItem) === null || _a === void 0 ? void 0 : _a.focused) {\n      this._activeComponentItem.blur();\n    }\n\n    super.destroy();\n    this.off('resize', this._resizeListener);\n\n    if (this._maximisedEnabled) {\n      this.off('maximised', this._maximisedListener);\n      this.off('minimised', this._minimisedListener);\n    }\n\n    this._header.destroy();\n  }\n\n  toConfig() {\n    let activeItemIndex;\n\n    if (this._activeComponentItem) {\n      activeItemIndex = this.contentItems.indexOf(this._activeComponentItem);\n\n      if (activeItemIndex < 0) {\n        throw new Error('active component item not found in stack');\n      }\n    }\n\n    if (this.contentItems.length > 0 && activeItemIndex === undefined) {\n      throw new Error('expected non-empty stack to have an active component item');\n    } else {\n      const result = {\n        type: 'stack',\n        content: this.calculateConfigContent(),\n        width: this.width,\n        minWidth: this.minWidth,\n        height: this.height,\n        minHeight: this.minHeight,\n        id: this.id,\n        isClosable: this.isClosable,\n        maximised: this.isMaximised,\n        header: this.createHeaderConfig(),\n        activeItemIndex\n      };\n      return result;\n    }\n  }\n  /**\n   * Ok, this one is going to be the tricky one: The user has dropped a {@link (ContentItem:class)} onto this stack.\n   *\n   * It was dropped on either the stacks header or the top, right, bottom or left bit of the content area\n   * (which one of those is stored in this._dropSegment). Now, if the user has dropped on the header the case\n   * is relatively clear: We add the item to the existing stack... job done (might be good to have\n   * tab reordering at some point, but lets not sweat it right now)\n   *\n   * If the item was dropped on the content part things are a bit more complicated. If it was dropped on either the\n   * top or bottom region we need to create a new column and place the items accordingly.\n   * Unless, of course if the stack is already within a column... in which case we want\n   * to add the newly created item to the existing column...\n   * either prepend or append it, depending on wether its top or bottom.\n   *\n   * Same thing for rows and left / right drop segments... so in total there are 9 things that can potentially happen\n   * (left, top, right, bottom) * is child of the right parent (row, column) + header drop\n   *\n   * @internal\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  onDrop(contentItem, area) {\n    /*\n     * The item was dropped on the header area. Just add it as a child of this stack and\n     * get the hell out of this logic\n     */\n    if (this._dropSegment === \"header\"\n    /* Header */\n    ) {\n      this.resetHeaderDropZone();\n\n      if (this._dropIndex === undefined) {\n        throw new UnexpectedUndefinedError('SODDI68990');\n      } else {\n        this.addChild(contentItem, this._dropIndex);\n        return;\n      }\n    }\n    /*\n     * The stack is empty. Let's just add the element.\n     */\n\n\n    if (this._dropSegment === \"body\"\n    /* Body */\n    ) {\n      this.addChild(contentItem, 0, true);\n      return;\n    }\n    /*\n     * The item was dropped on the top-, left-, bottom- or right- part of the content. Let's\n     * aggregate some conditions to make the if statements later on more readable\n     */\n\n\n    const isVertical = this._dropSegment === \"top\"\n    /* Top */\n    || this._dropSegment === \"bottom\"\n    /* Bottom */\n    ;\n    const isHorizontal = this._dropSegment === \"left\"\n    /* Left */\n    || this._dropSegment === \"right\"\n    /* Right */\n    ;\n    const insertBefore = this._dropSegment === \"top\"\n    /* Top */\n    || this._dropSegment === \"left\"\n    /* Left */\n    ;\n    const hasCorrectParent = isVertical && this.stackParent.isColumn || isHorizontal && this.stackParent.isRow;\n    const dimension = isVertical ? 'height' : 'width';\n    /*\n     * The content item can be either a component or a stack. If it is a component, wrap it into a stack\n     */\n\n    if (contentItem.isComponent) {\n      const itemConfig = ResolvedStackItemConfig.createDefault();\n      itemConfig.header = this.createHeaderConfig();\n      const stack = this.layoutManager.createAndInitContentItem(itemConfig, this);\n      stack.addChild(contentItem);\n      contentItem = stack;\n    }\n    /*\n     * If the contentItem that's being dropped is not dropped on a Stack (cases which just passed above and\n     * which would wrap the contentItem in a Stack) we need to check whether contentItem is a RowOrColumn.\n     * If it is, we need to re-wrap it in a Stack like it was when it was dragged by its Tab (it was dragged!).\n     */\n\n\n    if (contentItem.type === ItemType.row || contentItem.type === ItemType.column) {\n      const itemConfig = ResolvedStackItemConfig.createDefault();\n      itemConfig.header = this.createHeaderConfig();\n      const stack = this.layoutManager.createContentItem(itemConfig, this);\n      stack.addChild(contentItem);\n      contentItem = stack;\n    }\n    /*\n     * If the item is dropped on top or bottom of a column or left and right of a row, it's already\n     * layd out in the correct way. Just add it as a child\n     */\n\n\n    if (hasCorrectParent) {\n      const index = this.stackParent.contentItems.indexOf(this);\n      this.stackParent.addChild(contentItem, insertBefore ? index : index + 1, true);\n      this[dimension] *= 0.5;\n      contentItem[dimension] = this[dimension];\n      this.stackParent.updateSize();\n      /*\n       * This handles items that are dropped on top or bottom of a row or left / right of a column. We need\n       * to create the appropriate contentItem for them to live in\n       */\n    } else {\n      const type = isVertical ? ItemType.column : ItemType.row;\n      const itemConfig = ResolvedItemConfig.createDefault(type);\n      const rowOrColumn = this.layoutManager.createContentItem(itemConfig, this);\n      this.stackParent.replaceChild(this, rowOrColumn);\n      rowOrColumn.addChild(contentItem, insertBefore ? 0 : undefined, true);\n      rowOrColumn.addChild(this, insertBefore ? undefined : 0, true);\n      this[dimension] = 50;\n      contentItem[dimension] = 50;\n      rowOrColumn.updateSize();\n    }\n  }\n  /**\n   * If the user hovers above the header part of the stack, indicate drop positions for tabs.\n   * otherwise indicate which segment of the body the dragged item would be dropped on\n   *\n   * @param x - Absolute Screen X\n   * @param y - Absolute Screen Y\n   * @internal\n   */\n\n\n  highlightDropZone(x, y) {\n    for (const key in this._contentAreaDimensions) {\n      const segment = key;\n      const area = this._contentAreaDimensions[segment].hoverArea;\n\n      if (area.x1 < x && area.x2 > x && area.y1 < y && area.y2 > y) {\n        if (segment === \"header\"\n        /* Header */\n        ) {\n          this._dropSegment = \"header\"\n          /* Header */\n          ;\n          this.highlightHeaderDropZone(this._header.leftRightSided ? y : x);\n        } else {\n          this.resetHeaderDropZone();\n          this.highlightBodyDropZone(segment);\n        }\n\n        return;\n      }\n    }\n  }\n  /** @internal */\n\n\n  getArea() {\n    if (this.element.style.display === 'none') {\n      return null;\n    }\n\n    const headerArea = super.getElementArea(this._header.element);\n    const contentArea = super.getElementArea(this._childElementContainer);\n\n    if (headerArea === null || contentArea === null) {\n      throw new UnexpectedNullError('SGAHC13086');\n    }\n\n    const contentWidth = contentArea.x2 - contentArea.x1;\n    const contentHeight = contentArea.y2 - contentArea.y1;\n    this._contentAreaDimensions = {\n      header: {\n        hoverArea: {\n          x1: headerArea.x1,\n          y1: headerArea.y1,\n          x2: headerArea.x2,\n          y2: headerArea.y2\n        },\n        highlightArea: {\n          x1: headerArea.x1,\n          y1: headerArea.y1,\n          x2: headerArea.x2,\n          y2: headerArea.y2\n        }\n      }\n    };\n    /**\n     * Highlight the entire body if the stack is empty\n     */\n\n    if (this.contentItems.length === 0) {\n      this._contentAreaDimensions.body = {\n        hoverArea: {\n          x1: contentArea.x1,\n          y1: contentArea.y1,\n          x2: contentArea.x2,\n          y2: contentArea.y2\n        },\n        highlightArea: {\n          x1: contentArea.x1,\n          y1: contentArea.y1,\n          x2: contentArea.x2,\n          y2: contentArea.y2\n        }\n      };\n      return super.getElementArea(this.element);\n    } else {\n      this._contentAreaDimensions.left = {\n        hoverArea: {\n          x1: contentArea.x1,\n          y1: contentArea.y1,\n          x2: contentArea.x1 + contentWidth * 0.25,\n          y2: contentArea.y2\n        },\n        highlightArea: {\n          x1: contentArea.x1,\n          y1: contentArea.y1,\n          x2: contentArea.x1 + contentWidth * 0.5,\n          y2: contentArea.y2\n        }\n      };\n      this._contentAreaDimensions.top = {\n        hoverArea: {\n          x1: contentArea.x1 + contentWidth * 0.25,\n          y1: contentArea.y1,\n          x2: contentArea.x1 + contentWidth * 0.75,\n          y2: contentArea.y1 + contentHeight * 0.5\n        },\n        highlightArea: {\n          x1: contentArea.x1,\n          y1: contentArea.y1,\n          x2: contentArea.x2,\n          y2: contentArea.y1 + contentHeight * 0.5\n        }\n      };\n      this._contentAreaDimensions.right = {\n        hoverArea: {\n          x1: contentArea.x1 + contentWidth * 0.75,\n          y1: contentArea.y1,\n          x2: contentArea.x2,\n          y2: contentArea.y2\n        },\n        highlightArea: {\n          x1: contentArea.x1 + contentWidth * 0.5,\n          y1: contentArea.y1,\n          x2: contentArea.x2,\n          y2: contentArea.y2\n        }\n      };\n      this._contentAreaDimensions.bottom = {\n        hoverArea: {\n          x1: contentArea.x1 + contentWidth * 0.25,\n          y1: contentArea.y1 + contentHeight * 0.5,\n          x2: contentArea.x1 + contentWidth * 0.75,\n          y2: contentArea.y2\n        },\n        highlightArea: {\n          x1: contentArea.x1,\n          y1: contentArea.y1 + contentHeight * 0.5,\n          x2: contentArea.x2,\n          y2: contentArea.y2\n        }\n      };\n      return super.getElementArea(this.element);\n    }\n  }\n  /**\n   * Programmatically operate with header position.\n   *\n   * @param position -\n   *\n   * @returns previous header position\n   * @internal\n   */\n\n\n  positionHeader(position) {\n    if (this._header.side !== position) {\n      this._header.setSide(position);\n\n      this._headerSideChanged = true;\n      this.setupHeaderPosition();\n    }\n  }\n  /** @internal */\n\n\n  updateNodeSize() {\n    if (this.element.style.display !== 'none') {\n      const content = getElementWidthAndHeight(this.element);\n\n      if (this._header.show) {\n        const dimension = this._header.leftRightSided ? WidthOrHeightPropertyName.width : WidthOrHeightPropertyName.height;\n        content[dimension] -= this.layoutManager.layoutConfig.dimensions.headerHeight;\n      }\n\n      this._childElementContainer.style.width = numberToPixels(content.width);\n      this._childElementContainer.style.height = numberToPixels(content.height);\n\n      for (let i = 0; i < this.contentItems.length; i++) {\n        this.contentItems[i].element.style.width = numberToPixels(content.width);\n        this.contentItems[i].element.style.height = numberToPixels(content.height);\n      }\n\n      this.emit('resize');\n      this.emitStateChangedEvent();\n    }\n  }\n  /** @internal */\n\n\n  highlightHeaderDropZone(x) {\n    // Only walk over the visible tabs\n    const tabsLength = this._header.lastVisibleTabIndex + 1;\n    const dropTargetIndicator = this.layoutManager.dropTargetIndicator;\n\n    if (dropTargetIndicator === null) {\n      throw new UnexpectedNullError('SHHDZDTI97110');\n    }\n\n    let area; // Empty stack\n\n    if (tabsLength === 0) {\n      const headerOffset = getJQueryOffset(this._header.element);\n      const elementHeight = getElementHeight(this._header.element);\n      area = {\n        x1: headerOffset.left,\n        x2: headerOffset.left + 100,\n        y1: headerOffset.top + elementHeight - 20,\n        y2: headerOffset.top + elementHeight\n      };\n    } else {\n      let tabIndex = 0; // This indicates whether our cursor is exactly over a tab\n\n      let isAboveTab = false;\n      let tabTop;\n      let tabLeft;\n      let tabWidth;\n      let tabElement;\n\n      do {\n        tabElement = this._header.tabs[tabIndex].element;\n        const offset = getJQueryOffset(tabElement);\n\n        if (this._header.leftRightSided) {\n          tabLeft = offset.top;\n          tabTop = offset.left;\n          tabWidth = getElementHeight(tabElement);\n        } else {\n          tabLeft = offset.left;\n          tabTop = offset.top;\n          tabWidth = getElementWidth(tabElement);\n        }\n\n        if (x >= tabLeft && x < tabLeft + tabWidth) {\n          isAboveTab = true;\n        } else {\n          tabIndex++;\n        }\n      } while (tabIndex < tabsLength && !isAboveTab); // If we're not above any tabs, or to the right of any tab, we are out of the area, so give up\n\n\n      if (isAboveTab === false && x < tabLeft) {\n        return;\n      }\n\n      const halfX = tabLeft + tabWidth / 2;\n\n      if (x < halfX) {\n        this._dropIndex = tabIndex;\n        tabElement.insertAdjacentElement('beforebegin', this.layoutManager.tabDropPlaceholder);\n      } else {\n        this._dropIndex = Math.min(tabIndex + 1, tabsLength);\n        tabElement.insertAdjacentElement('afterend', this.layoutManager.tabDropPlaceholder);\n      }\n\n      const tabDropPlaceholderOffset = getJQueryOffset(this.layoutManager.tabDropPlaceholder);\n      const tabDropPlaceholderWidth = getElementWidth(this.layoutManager.tabDropPlaceholder);\n\n      if (this._header.leftRightSided) {\n        const placeHolderTop = tabDropPlaceholderOffset.top;\n        area = {\n          x1: tabTop,\n          x2: tabTop + tabElement.clientHeight,\n          y1: placeHolderTop,\n          y2: placeHolderTop + tabDropPlaceholderWidth\n        };\n      } else {\n        const placeHolderLeft = tabDropPlaceholderOffset.left;\n        area = {\n          x1: placeHolderLeft,\n          x2: placeHolderLeft + tabDropPlaceholderWidth,\n          y1: tabTop,\n          y2: tabTop + tabElement.clientHeight\n        };\n      }\n    }\n\n    dropTargetIndicator.highlightArea(area);\n    return;\n  }\n  /** @internal */\n\n\n  resetHeaderDropZone() {\n    this.layoutManager.tabDropPlaceholder.remove();\n  }\n  /** @internal */\n\n\n  setupHeaderPosition() {\n    setElementDisplayVisibility(this._header.element, this._header.show);\n    this.element.classList.remove(\"lm_left\"\n    /* Left */\n    , \"lm_right\"\n    /* Right */\n    , \"lm_bottom\"\n    /* Bottom */\n    );\n\n    if (this._header.leftRightSided) {\n      this.element.classList.add('lm_' + this._header.side);\n    } //if ([Side.right, Side.bottom].includes(this._header.side)) {\n    //    // move the header behind the content.\n    //    this.element.appendChild(this._header.element);\n    //}\n\n\n    this.updateSize();\n  }\n  /** @internal */\n\n\n  highlightBodyDropZone(segment) {\n    if (this._contentAreaDimensions === undefined) {\n      throw new UnexpectedUndefinedError('SHBDZC82265');\n    } else {\n      const highlightArea = this._contentAreaDimensions[segment].highlightArea;\n      const dropTargetIndicator = this.layoutManager.dropTargetIndicator;\n\n      if (dropTargetIndicator === null) {\n        throw new UnexpectedNullError('SHBDZD96110');\n      } else {\n        dropTargetIndicator.highlightArea(highlightArea);\n        this._dropSegment = segment;\n      }\n    }\n  }\n  /** @internal */\n\n\n  handleResize() {\n    this._header.updateTabSizes();\n  }\n  /** @internal */\n\n\n  handleMaximised() {\n    this._header.processMaximised();\n  }\n  /** @internal */\n\n\n  handleMinimised() {\n    this._header.processMinimised();\n  }\n  /** @internal */\n\n\n  handlePopoutEvent() {\n    this.popout();\n  }\n  /** @internal */\n\n\n  handleHeaderClickEvent(ev) {\n    const eventName = EventEmitter.headerClickEventName;\n    const bubblingEvent = new EventEmitter.ClickBubblingEvent(eventName, this, ev);\n    this.emit(eventName, bubblingEvent);\n  }\n  /** @internal */\n\n\n  handleHeaderTouchStartEvent(ev) {\n    const eventName = EventEmitter.headerTouchStartEventName;\n    const bubblingEvent = new EventEmitter.TouchStartBubblingEvent(eventName, this, ev);\n    this.emit(eventName, bubblingEvent);\n  }\n  /** @internal */\n\n\n  handleHeaderComponentRemoveEvent(item) {\n    this.removeChild(item, false);\n  }\n  /** @internal */\n\n\n  handleHeaderComponentFocusEvent(item) {\n    this.setActiveComponentItem(item, true);\n  }\n  /** @internal */\n\n\n  handleHeaderComponentStartDragEvent(x, y, dragListener, componentItem) {\n    if (this.isMaximised === true) {\n      this.toggleMaximise();\n    }\n\n    this.layoutManager.startComponentDrag(x, y, dragListener, componentItem, this);\n  }\n  /** @internal */\n\n\n  createHeaderConfig() {\n    if (!this._headerSideChanged) {\n      return ResolvedHeaderedItemConfig.Header.createCopy(this._headerConfig);\n    } else {\n      const show = this._header.show ? this._header.side : false;\n      let result = ResolvedHeaderedItemConfig.Header.createCopy(this._headerConfig, show);\n\n      if (result === undefined) {\n        result = {\n          show,\n          popout: undefined,\n          maximise: undefined,\n          close: undefined,\n          minimise: undefined,\n          tabDropdown: undefined\n        };\n      }\n\n      return result;\n    }\n  }\n  /** @internal */\n\n\n  emitStateChangedEvent() {\n    this.emitBaseBubblingEvent('stateChanged');\n  }\n\n}\n/** @public */\n\n(function (Stack) {\n  /** @internal */\n  function createElement(document) {\n    const element = document.createElement('div');\n    element.classList.add(\"lm_item\"\n    /* Item */\n    );\n    element.classList.add(\"lm_stack\"\n    /* Stack */\n    );\n    return element;\n  }\n\n  Stack.createElement = createElement;\n})(Stack || (Stack = {}));","map":{"version":3,"mappings":"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","names":["ItemConfig","ResolvedHeaderedItemConfig","ResolvedItemConfig","ResolvedStackItemConfig","Header","AssertError","UnexpectedNullError","UnexpectedUndefinedError","EventEmitter","getJQueryOffset","ItemType","Side","WidthOrHeightPropertyName","getElementHeight","getElementWidth","getElementWidthAndHeight","numberToPixels","setElementDisplayVisibility","ComponentItem","ComponentParentableItem","ContentItem","Stack","constructor","layoutManager","config","parent","createElement","document","handleResize","handleMaximised","handleMinimised","_headerConfig","header","layoutHeaderConfig","layoutConfig","configContent","content","componentHeaderConfig","length","undefined","firstChildItemConfig","_initialWantMaximise","maximised","_initialActiveItemIndex","activeItemIndex","_a","show","_b","_c","_d","popout","_e","_f","_g","maximise","_h","_j","_k","close","_l","_m","_o","minimise","_p","_q","_r","tabDropdown","_s","_t","_u","_maximisedEnabled","headerSettings","side","top","popoutEnabled","popoutLabel","maximiseEnabled","maximiseLabel","closeEnabled","closeLabel","minimiseEnabled","minimiseLabel","tabDropdownEnabled","tabDropdownLabel","_header","isClosable","getActiveComponentItem","remove","handlePopoutEvent","toggleMaximise","ev","handleHeaderClickEvent","handleHeaderTouchStartEvent","item","handleHeaderComponentRemoveEvent","handleHeaderComponentFocusEvent","x","y","dragListener","handleHeaderComponentStartDragEvent","isStack","_childElementContainer","classList","add","on","_resizeListener","_maximisedListener","_minimisedListener","element","appendChild","setupHeaderPosition","updateClosability","childElementContainer","headerShow","headerSide","headerLeftRightSided","leftRightSided","contentAreaDimensions","_contentAreaDimensions","initialWantMaximise","isMaximised","maximisedStack","stackParent","Error","updateSize","beginVirtualSizedContainerAdding","updateNodeSize","updateContentItemsSize","endVirtualSizedContainerAdding","init","isInitialised","i","contentItems","contentItemCount","id","contentItem","createTab","hide","setActiveComponentItem","updateTabSizes","initContentItems","setActiveContentItem","isComponentItem","componentItem","focus","suppressFocusEvent","_activeComponentItem","indexOf","processActiveComponentChanged","emit","emitStateChangedEvent","focused","setFocusedComponentItem","getActiveContentItem","focusActiveContentItem","setFocusedValue","value","applyFocusedValue","setRowColumnClosable","newComponent","componentType","componentState","title","index","itemConfig","type","newItem","addComponent","addItem","checkMinimiseMaximisedStack","resolvedItemConfig","resolve","createAndInitContentItem","addChild","removeChild","keepChild","stackWillBeDeleted","blur","newActiveComponentIdx","removeTab","setMaximisedStack","enterStackMaximised","exitStackMaximised","destroy","off","toConfig","result","calculateConfigContent","width","minWidth","height","minHeight","createHeaderConfig","onDrop","area","_dropSegment","resetHeaderDropZone","_dropIndex","isVertical","isHorizontal","insertBefore","hasCorrectParent","isColumn","isRow","dimension","isComponent","createDefault","stack","row","column","createContentItem","rowOrColumn","replaceChild","highlightDropZone","key","segment","hoverArea","x1","x2","y1","y2","highlightHeaderDropZone","highlightBodyDropZone","getArea","style","display","headerArea","getElementArea","contentArea","contentWidth","contentHeight","highlightArea","body","left","right","bottom","positionHeader","position","setSide","_headerSideChanged","dimensions","headerHeight","tabsLength","lastVisibleTabIndex","dropTargetIndicator","headerOffset","elementHeight","tabIndex","isAboveTab","tabTop","tabLeft","tabWidth","tabElement","tabs","offset","halfX","insertAdjacentElement","tabDropPlaceholder","Math","min","tabDropPlaceholderOffset","tabDropPlaceholderWidth","placeHolderTop","clientHeight","placeHolderLeft","processMaximised","processMinimised","eventName","headerClickEventName","bubblingEvent","ClickBubblingEvent","headerTouchStartEventName","TouchStartBubblingEvent","startComponentDrag","createCopy","emitBaseBubblingEvent"],"sourceRoot":"","sources":["../../../../src/ts/items/stack.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}